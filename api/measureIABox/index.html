<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Marloes van Heukelum" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>MeasureIABox - MeasureIA Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "MeasureIABox";
        var mkdocs_page_input_path = "api/measureIABox.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MeasureIA Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../usage/">Usage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../output_structure/">Output</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../roadmap/">Roadmap</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">MeasureIABox</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#measureia.MeasureIABox">MeasureIABox</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#measureia.MeasureIABox.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#measureia.MeasureIABox.measure_xi_w">measure_xi_w</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#measureia.MeasureIABox.measure_xi_multipoles">measure_xi_multipoles</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../measureIALightcone/">MeasureIALightcone</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MeasureIABase/">MeasureIABase</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MeasureJackknife/">MeasureJackknife</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MeasureWBox/">MeasureWBox</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MeasureMBox/">MeasureMultipolesBox</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SimInfo/">SimInfo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ReadData/">ReadData</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MeasureIA Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">MeasureIABox</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="measureia">MeasureIA</h1>


<div class="doc doc-object doc-class">



<h2 id="measureia.MeasureIABox" class="doc doc-heading">
            <code>measureia.MeasureIABox</code>


</h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="measureia.MeasureJackknife (measureia.measure_jackknife.MeasureJackknife)" href="../MeasureJackknife/#measureia.MeasureJackknife">MeasureJackknife</a></code></p>


        <p>Manages the IA correlation function measurement methods used in the MeasureIA package based on speed and input.
This class is used to call the methods that measure w_gg, w_g+ and multipoles for simulations in cartesian coordinates.
Depending on the input parameters, various correlations incl covariance estimates are measured for given data.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="measure_xi_w(dataset_name, corr_type, num_jk=0, measure_cov=True, file_tree_path=None, masks=None, remove_tree_file=True, save_jk_terms=False) (measureia.MeasureIABox.measure_xi_w)" href="#measureia.MeasureIABox.measure_xi_w">measure_xi_w</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Compute projected correlations $w_{gg}$ and/or $w_{g+}$.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="measure_xi_multipoles(dataset_name, corr_type, num_jk, measure_cov=True, file_tree_path=None, masks=None, remove_tree_file=True, rp_cut=None) (measureia.MeasureIABox.measure_xi_multipoles)" href="#measureia.MeasureIABox.measure_xi_multipoles">measure_xi_multipoles</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Compute multipoles of the correlation functions, $\tilde{\xi}<em>{gg,0}$ and/or $\tilde{\xi}</em>{g+,2}$.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Inherits attributes from 'SimInfo', where 'boxsize', 'L_0p5' and 'snap_group' are used in this class.
Inherits attributes from 'MeasureIABase', where 'data', 'output_file_name', 'periodicity', 'Num_position',
'Num_shape', 'r_min', 'r_max', 'num_bins_r', 'num_bins_pi', 'r_bins', 'pi_bins', 'mu_r_bins' are used.</p>
</details>







              <details class="quote">
                <summary>Source code in <code>src/measureia/measure_IA.py</code></summary>
                <pre class="highlight"><code class="language-python">class MeasureIABox(MeasureJackknife):
	r"""Manages the IA correlation function measurement methods used in the MeasureIA package based on speed and input.
	This class is used to call the methods that measure w_gg, w_g+ and multipoles for simulations in cartesian coordinates.
	Depending on the input parameters, various correlations incl covariance estimates are measured for given data.

	Methods
	-------
	measure_xi_w()
		Compute projected correlations $w_{gg}$ and/or $w_{g+}$.
	measure_xi_multipoles()
		Compute multipoles of the correlation functions, $\tilde{\xi}_{gg,0}$ and/or $\tilde{\xi}_{g+,2}$.

	Notes
	-----
	Inherits attributes from 'SimInfo', where 'boxsize', 'L_0p5' and 'snap_group' are used in this class.
	Inherits attributes from 'MeasureIABase', where 'data', 'output_file_name', 'periodicity', 'Num_position',
	'Num_shape', 'r_min', 'r_max', 'num_bins_r', 'num_bins_pi', 'r_bins', 'pi_bins', 'mu_r_bins' are used.

	"""

	def __init__(
			self,
			data,
			output_file_name,
			simulation=None,
			snapshot=None,
			separation_limits=[0.1, 20.0],
			num_bins_r=8,
			num_bins_pi=20,
			pi_max=None,
			boxsize=None,
			periodicity=True,
			num_nodes=1,
	):
		"""
		The __init__ method of the MeasureIABox class.

		Parameters
		----------
		num_nodes : int, optional
			Number of cores to be used in multiprocessing. Default is 1.

		Notes
		-----
		Constructor parameters 'data', 'output_file_name', 'simulation', 'snapshot', 'separation_limits', 'num_bins_r',
		'num_bins_pi', 'pi_max', 'boxsize' and 'periodicity' are passed to MeasureIABase.

		"""
		super().__init__(data, output_file_name, simulation, snapshot, separation_limits, num_bins_r, num_bins_pi,
						 pi_max, boxsize, periodicity)
		self.num_nodes = num_nodes
		self.randoms_data = None
		self.data_dir = None
		self.num_samples = None

		return

	def measure_xi_w(self, dataset_name, corr_type, num_jk=0, measure_cov=True, file_tree_path=None, masks=None,
					 remove_tree_file=True, save_jk_terms=False):
		"""Measures xi_gg, xi_g+ and w_gg, w_g+ including jackknife covariance if desired.
		Manages the various _measure_xi_rp_pi_sims and _measure_jackknife_covariance_sims options in MeasureWSimulations
		and MeasureJackknife.

		Parameters
		----------
		dataset_name : str
			Name of the dataset in the output file.
		corr_type : str
			Type of correlation to be measured. Choose from [g+, gg, both].
		num_jk : int, optional
			Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
		measure_cov : bool, optional
			If True, jackknife covariance is measured. Default is True
		file_tree_path : str or NoneType, optional
			Path to where the tree information is temporarily stored [file name generated automatically].
			If None (default), no trees are used in the calculation.
			Note that the use of trees speeds up the calculations significantly.
		masks : dict or NoneType, optional
			Directory of mask information in the same form as the data dictionary, where the masks are placed over
			the data to apply selections. Default is None.
		remove_tree_file : bool, optional
			If True (default), the file that stores the tree information is removed after the measurements.
		save_jk_terms : bool, optional
			If True, DD and S+D terms of the jackknife realisations are also saved in the output file.
			These terms are automatically saved when only 1 core is used in the measurements. Default is False.

		"""
		if measure_cov:
			try:
				assert sympy.integer_nthroot(num_jk, 3)[1]
				L = sympy.integer_nthroot(num_jk, 3)[0]
			except AssertionError:
				raise ValueError(
					f"Use x^3 as input for num_jk, with x as an int. {float(int(num_jk ** (1. / 3)))},{num_jk ** (1. / 3)}")
			if self.num_nodes == 1:
				multiproc_bool = False
				save_tree = True
			elif num_jk &gt; 0.5 * self.num_nodes:
				multiproc_bool = True
				save_tree = True
			else:
				multiproc_bool = True
				save_tree = False
		else:
			if self.num_nodes == 1:
				multiproc_bool = False
				save_tree = False
			elif self.num_nodes &gt; 2:
				multiproc_bool = True
				save_tree = False
			else:
				multiproc_bool = True
				save_tree = True
		if save_tree and file_tree_path == False:
			save_tree = False
			file_tree_path = None
		elif save_tree and file_tree_path == None:
			raise ValueError(
				"Input file_tree_path for faster computation. Do not want to use trees? Input file_path_tree=False.")
		try:
			RA = self.data["RA"]
			sim_bool = False
		except:
			sim_bool = True
		if not sim_bool:
			print("Given data is observational, use measure_xi_w_obs method instead.")
		else:
			if multiproc_bool and save_tree:
				self._measure_xi_rp_pi_sims_tree(tree_input=None, masks=masks, dataset_name=dataset_name,
												 return_output=False, print_num=True, dataset_name_tree=None,
												 save_tree=save_tree, file_tree_path=file_tree_path)
				self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
				if measure_cov:
					self._measure_jackknife_covariance_sims_multiprocessing(masks=masks, corr_type=[corr_type, "w"],
																			dataset_name=dataset_name, L_subboxes=L,
																			rp_cut=None,
																			num_nodes=self.num_nodes, twoD=False,
																			tree=True,
																			tree_saved=True,
																			file_tree_path=file_tree_path,
																			remove_tree_file=remove_tree_file,
																			save_jk_terms=save_jk_terms)
			elif not multiproc_bool and save_tree:
				self._measure_xi_rp_pi_sims_tree(tree_input=None, masks=masks, dataset_name=dataset_name,
												 return_output=False, print_num=True, dataset_name_tree=None,
												 save_tree=save_tree, file_tree_path=file_tree_path)
				self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
				if measure_cov:
					self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
															dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
															tree_saved=True, file_tree_path=file_tree_path,
															remove_tree_file=remove_tree_file)
			elif multiproc_bool and not save_tree:
				print("yes")
				self._measure_xi_rp_pi_sims_multiprocessing(num_nodes=self.num_nodes, masks=masks,
															dataset_name=dataset_name, return_output=False,
															print_num=True)
				self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
				if measure_cov:
					self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
															dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
															num_nodes=self.num_nodes, tree_saved=False)
			else:
				self._measure_xi_rp_pi_sims_brute(masks=masks, dataset_name=dataset_name,
												  return_output=False, print_num=True)
				self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
				if measure_cov:
					self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
															dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
															num_nodes=self.num_nodes, tree_saved=False)

		return

	def measure_xi_multipoles(self, dataset_name, corr_type, num_jk, measure_cov=True, file_tree_path=None, masks=None,
							  remove_tree_file=True, rp_cut=None):
		"""Measures multipoles including jackknife covariance if desired.
		Manages the various _measure_xi_r_mu_r_sims and _measure_jackknife_covariance_sims options in
		MeasureMultipolesSimulations and MeasureJackknife.

		Parameters
		----------
		dataset_name : str
			Name of the dataset in the output file.
		corr_type : str
			Type of correlation to be measured. Choose from [g+, gg, both].
		num_jk : int, optional
			Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
		measure_cov : bool, optional
			If True, jackknife covariance is measured. Default is True
		file_tree_path : str or NoneType, optional
			Path to where the tree information is temporarily stored [file name generated automatically].
			If None (default), no trees are used in the calculation.
			Note that the use of trees speeds up the calculations significantly.
		masks : dict or NoneType, optional
			Directory of mask information in the same form as the data dictionary, where the masks are placed over
			the data to apply selections. Default is None.
		remove_tree_file : bool, optional
			If True (default), the file that stores the tree information is removed after the measurements.
		rp_cut : float or NoneType, optional
			Applies a minimum r_p value condition for pairs to be included. Default is None.

		"""
		if measure_cov:
			try:
				assert sympy.integer_nthroot(num_jk, 3)[1]
				L = sympy.integer_nthroot(num_jk, 3)[0]
			except AssertionError:
				raise ValueError("Use x^3 as input for num_jk, with x as an int.")
			if self.num_nodes == 1:
				multiproc_bool = False
				save_tree = True
			elif num_jk &gt; 0.5 * self.num_nodes:
				multiproc_bool = True
				save_tree = True
			else:
				multiproc_bool = True
				save_tree = False
		else:
			if self.num_nodes == 1:
				multiproc_bool = False
				save_tree = False
			elif self.num_nodes &gt; 2:
				multiproc_bool = True
				save_tree = False
			else:
				multiproc_bool = True
				save_tree = True
		if save_tree and file_tree_path == None:
			raise ValueError(
				"Input file_tree_path for faster computation. Do not want to use trees? Input file_path_tree=False.")
		elif save_tree and file_tree_path == False:
			save_tree = False
			file_tree_path = None
		try:
			RA = self.data["RA"]
			raise KeyError(
				"Lightcone input provided, use measure_xi_w_obs and measure_xi_multipoles_obs for measurements or "
				"provide carthesian coordinate data.")
		except KeyError:
			pass
		if multiproc_bool and save_tree:
			self._measure_xi_r_mur_sims_tree(tree_input=None, masks=masks,
											 dataset_name=dataset_name,
											 return_output=False, print_num=True,
											 dataset_name_tree=None, rp_cut=rp_cut,
											 save_tree=save_tree, file_tree_path=file_tree_path)
			self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims_multiprocessing(masks=masks,
																		corr_type=[corr_type, "multipoles"],
																		dataset_name=dataset_name, L_subboxes=L,
																		rp_cut=rp_cut,
																		num_nodes=self.num_nodes, twoD=False,
																		tree=True,
																		tree_saved=True,
																		file_tree_path=file_tree_path,
																		remove_tree_file=remove_tree_file)
		elif not multiproc_bool and save_tree:
			self._measure_xi_r_mur_sims_tree(tree_input=None, masks=masks,
											 dataset_name=dataset_name,
											 return_output=False, print_num=True,
											 dataset_name_tree=None, rp_cut=rp_cut,
											 save_tree=save_tree, file_tree_path=file_tree_path)
			self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
														dataset_name=dataset_name, L_subboxes=L, rp_cut=rp_cut,
														tree_saved=True, file_tree_path=file_tree_path,
														remove_tree_file=remove_tree_file)
		elif multiproc_bool and not save_tree:
			self._measure_xi_r_mur_sims_multiprocessing(num_nodes=self.num_nodes,
														masks=masks,
														dataset_name=dataset_name,
														return_output=False, rp_cut=rp_cut,
														print_num=True)
			self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
														dataset_name=dataset_name, L_subboxes=L,
														rp_cut=rp_cut, num_nodes=self.num_nodes,
														tree_saved=False)
		else:
			self._measure_xi_r_mur_sims_brute(masks=masks,
											  dataset_name=dataset_name,
											  return_output=False, print_num=True,
											  rp_cut=rp_cut)
			self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
														dataset_name=dataset_name, L_subboxes=L,
														rp_cut=rp_cut, num_nodes=self.num_nodes,
														tree_saved=False)

		return</code></pre>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="measureia.MeasureIABox.__init__" class="doc doc-heading">
            <code class="highlight language-python">__init__(data, output_file_name, simulation=None, snapshot=None, separation_limits=[0.1, 20.0], num_bins_r=8, num_bins_pi=20, pi_max=None, boxsize=None, periodicity=True, num_nodes=1)</code>

</h3>


    <div class="doc doc-contents ">

        <p>The <strong>init</strong> method of the MeasureIABox class.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>num_nodes</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Number of cores to be used in multiprocessing. Default is 1.
</code></pre>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>Constructor parameters 'data', 'output_file_name', 'simulation', 'snapshot', 'separation_limits', 'num_bins_r',
'num_bins_pi', 'pi_max', 'boxsize' and 'periodicity' are passed to MeasureIABase.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/measureia/measure_IA.py</code></summary>
              <pre class="highlight"><code class="language-python">def __init__(
		self,
		data,
		output_file_name,
		simulation=None,
		snapshot=None,
		separation_limits=[0.1, 20.0],
		num_bins_r=8,
		num_bins_pi=20,
		pi_max=None,
		boxsize=None,
		periodicity=True,
		num_nodes=1,
):
	"""
	The __init__ method of the MeasureIABox class.

	Parameters
	----------
	num_nodes : int, optional
		Number of cores to be used in multiprocessing. Default is 1.

	Notes
	-----
	Constructor parameters 'data', 'output_file_name', 'simulation', 'snapshot', 'separation_limits', 'num_bins_r',
	'num_bins_pi', 'pi_max', 'boxsize' and 'periodicity' are passed to MeasureIABase.

	"""
	super().__init__(data, output_file_name, simulation, snapshot, separation_limits, num_bins_r, num_bins_pi,
					 pi_max, boxsize, periodicity)
	self.num_nodes = num_nodes
	self.randoms_data = None
	self.data_dir = None
	self.num_samples = None

	return</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="measureia.MeasureIABox.measure_xi_w" class="doc doc-heading">
            <code class="highlight language-python">measure_xi_w(dataset_name, corr_type, num_jk=0, measure_cov=True, file_tree_path=None, masks=None, remove_tree_file=True, save_jk_terms=False)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Measures xi_gg, xi_g+ and w_gg, w_g+ including jackknife covariance if desired.
Manages the various _measure_xi_rp_pi_sims and _measure_jackknife_covariance_sims options in MeasureWSimulations
and MeasureJackknife.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <pre><code>Name of the dataset in the output file.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>corr_type</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <pre><code>Type of correlation to be measured. Choose from [g+, gg, both].
</code></pre>
              </div>
            </li>
            <li>
              <b><code>num_jk</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>measure_cov</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <pre><code>If True, jackknife covariance is measured. Default is True
</code></pre>
              </div>
            </li>
            <li>
              <b><code>file_tree_path</code></b>
                  (<code><span title="str">str</span> or <span title="NoneType">NoneType</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Path to where the tree information is temporarily stored [file name generated automatically].
If None (default), no trees are used in the calculation.
Note that the use of trees speeds up the calculations significantly.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>masks</code></b>
                  (<code><span title="dict">dict</span> or <span title="NoneType">NoneType</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Directory of mask information in the same form as the data dictionary, where the masks are placed over
the data to apply selections. Default is None.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>remove_tree_file</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <pre><code>If True (default), the file that stores the tree information is removed after the measurements.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>save_jk_terms</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <pre><code>If True, DD and S+D terms of the jackknife realisations are also saved in the output file.
These terms are automatically saved when only 1 core is used in the measurements. Default is False.
</code></pre>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/measureia/measure_IA.py</code></summary>
              <pre class="highlight"><code class="language-python">def measure_xi_w(self, dataset_name, corr_type, num_jk=0, measure_cov=True, file_tree_path=None, masks=None,
				 remove_tree_file=True, save_jk_terms=False):
	"""Measures xi_gg, xi_g+ and w_gg, w_g+ including jackknife covariance if desired.
	Manages the various _measure_xi_rp_pi_sims and _measure_jackknife_covariance_sims options in MeasureWSimulations
	and MeasureJackknife.

	Parameters
	----------
	dataset_name : str
		Name of the dataset in the output file.
	corr_type : str
		Type of correlation to be measured. Choose from [g+, gg, both].
	num_jk : int, optional
		Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
	measure_cov : bool, optional
		If True, jackknife covariance is measured. Default is True
	file_tree_path : str or NoneType, optional
		Path to where the tree information is temporarily stored [file name generated automatically].
		If None (default), no trees are used in the calculation.
		Note that the use of trees speeds up the calculations significantly.
	masks : dict or NoneType, optional
		Directory of mask information in the same form as the data dictionary, where the masks are placed over
		the data to apply selections. Default is None.
	remove_tree_file : bool, optional
		If True (default), the file that stores the tree information is removed after the measurements.
	save_jk_terms : bool, optional
		If True, DD and S+D terms of the jackknife realisations are also saved in the output file.
		These terms are automatically saved when only 1 core is used in the measurements. Default is False.

	"""
	if measure_cov:
		try:
			assert sympy.integer_nthroot(num_jk, 3)[1]
			L = sympy.integer_nthroot(num_jk, 3)[0]
		except AssertionError:
			raise ValueError(
				f"Use x^3 as input for num_jk, with x as an int. {float(int(num_jk ** (1. / 3)))},{num_jk ** (1. / 3)}")
		if self.num_nodes == 1:
			multiproc_bool = False
			save_tree = True
		elif num_jk &gt; 0.5 * self.num_nodes:
			multiproc_bool = True
			save_tree = True
		else:
			multiproc_bool = True
			save_tree = False
	else:
		if self.num_nodes == 1:
			multiproc_bool = False
			save_tree = False
		elif self.num_nodes &gt; 2:
			multiproc_bool = True
			save_tree = False
		else:
			multiproc_bool = True
			save_tree = True
	if save_tree and file_tree_path == False:
		save_tree = False
		file_tree_path = None
	elif save_tree and file_tree_path == None:
		raise ValueError(
			"Input file_tree_path for faster computation. Do not want to use trees? Input file_path_tree=False.")
	try:
		RA = self.data["RA"]
		sim_bool = False
	except:
		sim_bool = True
	if not sim_bool:
		print("Given data is observational, use measure_xi_w_obs method instead.")
	else:
		if multiproc_bool and save_tree:
			self._measure_xi_rp_pi_sims_tree(tree_input=None, masks=masks, dataset_name=dataset_name,
											 return_output=False, print_num=True, dataset_name_tree=None,
											 save_tree=save_tree, file_tree_path=file_tree_path)
			self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims_multiprocessing(masks=masks, corr_type=[corr_type, "w"],
																		dataset_name=dataset_name, L_subboxes=L,
																		rp_cut=None,
																		num_nodes=self.num_nodes, twoD=False,
																		tree=True,
																		tree_saved=True,
																		file_tree_path=file_tree_path,
																		remove_tree_file=remove_tree_file,
																		save_jk_terms=save_jk_terms)
		elif not multiproc_bool and save_tree:
			self._measure_xi_rp_pi_sims_tree(tree_input=None, masks=masks, dataset_name=dataset_name,
											 return_output=False, print_num=True, dataset_name_tree=None,
											 save_tree=save_tree, file_tree_path=file_tree_path)
			self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
														dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
														tree_saved=True, file_tree_path=file_tree_path,
														remove_tree_file=remove_tree_file)
		elif multiproc_bool and not save_tree:
			print("yes")
			self._measure_xi_rp_pi_sims_multiprocessing(num_nodes=self.num_nodes, masks=masks,
														dataset_name=dataset_name, return_output=False,
														print_num=True)
			self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
														dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
														num_nodes=self.num_nodes, tree_saved=False)
		else:
			self._measure_xi_rp_pi_sims_brute(masks=masks, dataset_name=dataset_name,
											  return_output=False, print_num=True)
			self._measure_w_g_i(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
			if measure_cov:
				self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "w"],
														dataset_name=dataset_name, L_subboxes=L, rp_cut=None,
														num_nodes=self.num_nodes, tree_saved=False)

	return</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="measureia.MeasureIABox.measure_xi_multipoles" class="doc doc-heading">
            <code class="highlight language-python">measure_xi_multipoles(dataset_name, corr_type, num_jk, measure_cov=True, file_tree_path=None, masks=None, remove_tree_file=True, rp_cut=None)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Measures multipoles including jackknife covariance if desired.
Manages the various _measure_xi_r_mu_r_sims and _measure_jackknife_covariance_sims options in
MeasureMultipolesSimulations and MeasureJackknife.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <pre><code>Name of the dataset in the output file.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>corr_type</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <pre><code>Type of correlation to be measured. Choose from [g+, gg, both].
</code></pre>
              </div>
            </li>
            <li>
              <b><code>num_jk</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <pre><code>Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>measure_cov</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <pre><code>If True, jackknife covariance is measured. Default is True
</code></pre>
              </div>
            </li>
            <li>
              <b><code>file_tree_path</code></b>
                  (<code><span title="str">str</span> or <span title="NoneType">NoneType</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Path to where the tree information is temporarily stored [file name generated automatically].
If None (default), no trees are used in the calculation.
Note that the use of trees speeds up the calculations significantly.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>masks</code></b>
                  (<code><span title="dict">dict</span> or <span title="NoneType">NoneType</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Directory of mask information in the same form as the data dictionary, where the masks are placed over
the data to apply selections. Default is None.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>remove_tree_file</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <pre><code>If True (default), the file that stores the tree information is removed after the measurements.
</code></pre>
              </div>
            </li>
            <li>
              <b><code>rp_cut</code></b>
                  (<code><span title="float">float</span> or <span title="NoneType">NoneType</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <pre><code>Applies a minimum r_p value condition for pairs to be included. Default is None.
</code></pre>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/measureia/measure_IA.py</code></summary>
              <pre class="highlight"><code class="language-python">def measure_xi_multipoles(self, dataset_name, corr_type, num_jk, measure_cov=True, file_tree_path=None, masks=None,
						  remove_tree_file=True, rp_cut=None):
	"""Measures multipoles including jackknife covariance if desired.
	Manages the various _measure_xi_r_mu_r_sims and _measure_jackknife_covariance_sims options in
	MeasureMultipolesSimulations and MeasureJackknife.

	Parameters
	----------
	dataset_name : str
		Name of the dataset in the output file.
	corr_type : str
		Type of correlation to be measured. Choose from [g+, gg, both].
	num_jk : int, optional
		Number of jackknife regions (needs to be x^3, with x an int) for the covariance measurement. Default is 0.
	measure_cov : bool, optional
		If True, jackknife covariance is measured. Default is True
	file_tree_path : str or NoneType, optional
		Path to where the tree information is temporarily stored [file name generated automatically].
		If None (default), no trees are used in the calculation.
		Note that the use of trees speeds up the calculations significantly.
	masks : dict or NoneType, optional
		Directory of mask information in the same form as the data dictionary, where the masks are placed over
		the data to apply selections. Default is None.
	remove_tree_file : bool, optional
		If True (default), the file that stores the tree information is removed after the measurements.
	rp_cut : float or NoneType, optional
		Applies a minimum r_p value condition for pairs to be included. Default is None.

	"""
	if measure_cov:
		try:
			assert sympy.integer_nthroot(num_jk, 3)[1]
			L = sympy.integer_nthroot(num_jk, 3)[0]
		except AssertionError:
			raise ValueError("Use x^3 as input for num_jk, with x as an int.")
		if self.num_nodes == 1:
			multiproc_bool = False
			save_tree = True
		elif num_jk &gt; 0.5 * self.num_nodes:
			multiproc_bool = True
			save_tree = True
		else:
			multiproc_bool = True
			save_tree = False
	else:
		if self.num_nodes == 1:
			multiproc_bool = False
			save_tree = False
		elif self.num_nodes &gt; 2:
			multiproc_bool = True
			save_tree = False
		else:
			multiproc_bool = True
			save_tree = True
	if save_tree and file_tree_path == None:
		raise ValueError(
			"Input file_tree_path for faster computation. Do not want to use trees? Input file_path_tree=False.")
	elif save_tree and file_tree_path == False:
		save_tree = False
		file_tree_path = None
	try:
		RA = self.data["RA"]
		raise KeyError(
			"Lightcone input provided, use measure_xi_w_obs and measure_xi_multipoles_obs for measurements or "
			"provide carthesian coordinate data.")
	except KeyError:
		pass
	if multiproc_bool and save_tree:
		self._measure_xi_r_mur_sims_tree(tree_input=None, masks=masks,
										 dataset_name=dataset_name,
										 return_output=False, print_num=True,
										 dataset_name_tree=None, rp_cut=rp_cut,
										 save_tree=save_tree, file_tree_path=file_tree_path)
		self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
		if measure_cov:
			self._measure_jackknife_covariance_sims_multiprocessing(masks=masks,
																	corr_type=[corr_type, "multipoles"],
																	dataset_name=dataset_name, L_subboxes=L,
																	rp_cut=rp_cut,
																	num_nodes=self.num_nodes, twoD=False,
																	tree=True,
																	tree_saved=True,
																	file_tree_path=file_tree_path,
																	remove_tree_file=remove_tree_file)
	elif not multiproc_bool and save_tree:
		self._measure_xi_r_mur_sims_tree(tree_input=None, masks=masks,
										 dataset_name=dataset_name,
										 return_output=False, print_num=True,
										 dataset_name_tree=None, rp_cut=rp_cut,
										 save_tree=save_tree, file_tree_path=file_tree_path)
		self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
		if measure_cov:
			self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
													dataset_name=dataset_name, L_subboxes=L, rp_cut=rp_cut,
													tree_saved=True, file_tree_path=file_tree_path,
													remove_tree_file=remove_tree_file)
	elif multiproc_bool and not save_tree:
		self._measure_xi_r_mur_sims_multiprocessing(num_nodes=self.num_nodes,
													masks=masks,
													dataset_name=dataset_name,
													return_output=False, rp_cut=rp_cut,
													print_num=True)
		self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
		if measure_cov:
			self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
													dataset_name=dataset_name, L_subboxes=L,
													rp_cut=rp_cut, num_nodes=self.num_nodes,
													tree_saved=False)
	else:
		self._measure_xi_r_mur_sims_brute(masks=masks,
										  dataset_name=dataset_name,
										  return_output=False, print_num=True,
										  rp_cut=rp_cut)
		self._measure_multipoles(corr_type=corr_type, dataset_name=dataset_name, return_output=False)
		if measure_cov:
			self._measure_jackknife_covariance_sims(masks=masks, corr_type=[corr_type, "multipoles"],
													dataset_name=dataset_name, L_subboxes=L,
													rp_cut=rp_cut, num_nodes=self.num_nodes,
													tree_saved=False)

	return</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../roadmap/" class="btn btn-neutral float-left" title="Roadmap"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../measureIALightcone/" class="btn btn-neutral float-right" title="MeasureIALightcone">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../roadmap/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../measureIALightcone/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
